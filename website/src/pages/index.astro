---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Human Agency Protocol - Infrastructure for Choice in the Age of Automation">
    <!-- Hero Section -->
    <section class="hero">
        <div class="version-wrapper">
            <span class="version">Version 0.1</span>
            <span class="version-date">November 2025</span>
        </div>
        <h1>The More AI Shapes Our Lives, the More It Must <span class="highlight">Ask Humans First</span></h1>
        <div class="cta-group">
            <a href="/protocol" class="btn btn-primary">Explore the Protocol</a>
            <button id="copy-context" class="btn btn-secondary">Ask your AI about this protocol</button>
        </div>
    </section>

    <!-- Why This Matters -->
    <section class="why-matters">
        <h2 class="section-title">Why This Matters</h2>
        <div class="why-content">
            <p>
                AI is becoming deeply embedded in daily life.
                The real risk isn't bad intent - it's AI acting on unclear or assumed meaning.
           
                AI naturally fills in missing meaning. Without a rule that forces it to stop, it will act on guesses.
            </p>
            <p>
                The Human Agency Protocol fixes this by enforcing mandatory human checkpoints.
                When meaning drifts or direction becomes uncertain, AI must stop, ask, and wait.
                It cannot infer. It cannot proceed alone.
            </p>
            <p class="emphasis">
                The Human Agency Protocol is the rule that keeps AI aligned with human meaning - no guessing, no inferring, no acting alone.
            </p>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works">
        <h2 class="section-title">How It Works</h2>
        <h3 class="mechanism-title">Stop → Ask → Proceed</h3>

        <div class="steps">
            <div class="step">
                <div class="step-number">1</div>
                <h4>Stop</h4>
                <p>AI detects ambiguity, drift, or conflicting intent.</p>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <h4>Ask</h4>
                <p>The protocol triggers a structured, human-facing question. The AI must wait for a human answer.</p>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <h4>Proceed</h4>
                <p>Only after meaning or direction is clarified can the system act.</p>
            </div>
        </div>

           </section>

    <!-- Core Principles -->
    <section class="principles">
        <h2 class="section-title">Core Principles</h2>

        <div class="cards">
            <div class="card">
                <h3>Mandatory Human Checkpoints</h3>
                <p>
                    AI must pause and ask humans whenever meaning becomes unclear - no assumptions, no bypass.
                </p>
            </div>

            <div class="card">
                <h3>Privacy by Architecture</h3>
                <p>
                    Only minimal structural signals leave the system. No transcripts. No personal data. No content exposure.
                </p>
            </div>

            <div class="card">
                <h3>Open, Enforced Governance</h3>
                <p>
                    A transparent protocol maintained by qualified stewards. No owners. No extraction. Compliance required.
                </p>
            </div>
        </div>
    </section>

    <!-- Documentation -->
    <section class="protocol-nav" id="protocol">
        <h2 class="section-title">Complete Specification</h2>

        <div class="protocol-links">
            <a href="/protocol" class="protocol-link">
                <div class="label">Core</div>
                <h3>The Protocol</h3>
                <p>The foundational specification defining how agency can be described, measured, and exchanged in AI-native systems.</p>
                <div class="arrow">Read the protocol →</div>
            </a>

            <a href="/service" class="protocol-link">
                <div class="label">Implementation</div>
                <h3>Service Providers</h3>
                <p>Technical specification for HAP Service Providers - infrastructure for running HAP-compliant systems at scale.</p>
                <div class="arrow">View architecture →</div>
            </a>

            <a href="/governance" class="protocol-link">
                <div class="label">Adoption</div>
                <h3>Governance Proposal</h3>
                <p>Regional adoption assessment examining how HAP can be integrated into regulatory frameworks with enforcement mechanisms.</p>
                <div class="arrow">Read assessment →</div>
            </a>
        </div>
    </section>

</BaseLayout>

<style>
    /* Hero Section */
    .hero {
        max-width: 1200px;
        margin: 0 auto;
        padding: 12rem 1.5rem 6rem;
        min-height: 80vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .hero h1 {
        font-size: clamp(2.5rem, 6vw, 4.5rem);
        font-weight: 700;
        line-height: 1.1;
        letter-spacing: -0.03em;
        max-width: 900px;
        margin-bottom: 3rem;
    }

    .hero .highlight {
        color: var(--accent);
    }

    .hero .version-wrapper {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
        margin-bottom: 1rem;
    }

    .hero .version {
        display: inline-block;
        color: var(--text-tertiary);
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        padding: 0.35rem 0.85rem;
        border-radius: 2rem;
        font-weight: 500;
    }

    .hero .version-date {
        color: var(--text-tertiary);
        font-weight: 400;
    }

    .cta-group {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
    }

    /* Why This Matters */
    .why-matters {
        max-width: 1200px;
        margin: 6rem auto;
        padding: 0 1.5rem;
    }

    .why-content {
        max-width: 800px;
    }

    .why-content p {
        font-size: clamp(1.1rem, 2vw, 1.3rem);
        line-height: 1.8;
        margin-bottom: 2rem;
        color: var(--text-primary);
    }

    .why-content .emphasis {
        font-size: clamp(1.3rem, 2.5vw, 1.6rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 3rem;
    }

    /* How It Works */
    .how-it-works {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .mechanism-title {
        font-size: clamp(1.5rem, 3vw, 2rem);
        font-weight: 600;
        color: var(--accent);
        margin-bottom: 3rem;
        text-align: center;
    }

    .steps {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .step {
        background: var(--bg-elevated);
        border: 2px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem 2rem;
        text-align: center;
    }


    .step-number {
        width: 3rem;
        height: 3rem;
        background: var(--accent);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: 700;
        margin: 0 auto 1.5rem;
    }

    .step h4 {
        font-size: 1.3rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .step p {
        color: var(--text-secondary);
        line-height: 1.6;
        margin-bottom: 0;
    }

    .enforcement-statement {
        font-size: clamp(1.2rem, 2vw, 1.4rem);
        font-weight: 700;
        color: var(--text-primary);
        margin-top: 2rem;
    }

    /* Intelligence Section */
    .intelligence {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .section-title-centered {
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 2rem;
    }

    .intelligence-intro {
        font-size: clamp(1.1rem, 2vw, 1.3rem);
        max-width: 900px;
        margin: 0 0 4rem;
        color: var(--text-primary);
    }

    .intelligence-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
        margin-bottom: 3rem;
    }

    .intelligence-card {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .intelligence-card h3 {
        font-size: 1.4rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .intelligence-card .card-desc {
        color: var(--text-secondary);
        margin-bottom: 1rem;
        font-size: 0.95rem;
    }

    .intelligence-card ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .intelligence-card li {
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border);
        color: var(--text-secondary);
        font-size: 0.95rem;
    }

    .intelligence-card li:last-child {
        border-bottom: none;
    }

    .privacy-note-small {
        margin-top: 1.5rem;
        color: var(--text-tertiary);
        font-size: 0.9rem;
        font-style: italic;
    }

    .intelligence-conclusion {
        font-size: clamp(1.3rem, 2.5vw, 1.6rem);
        font-weight: 600;
        color: var(--accent);
        margin-top: 3rem;
    }

    /* Shared Styles */
    .section-label {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: var(--accent);
        font-weight: 600;
        margin-bottom: 1rem;
    }

    .section-title {
        font-size: clamp(2rem, 4vw, 3rem);
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 4rem;
        max-width: 600px;
    }

    /* Principles */
    .principles {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 2rem;
    }

    .card {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 1rem;
        padding: 2.5rem;
    }

    .card h3 {
        font-size: 1.4rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--text-primary);
    }

    .card p {
        color: var(--text-secondary);
        line-height: 1.7;
    }

    /* Documentation */
    .protocol-nav {
        max-width: 1200px;
        margin: 8rem auto;
        padding: 0 1.5rem;
    }

    .protocol-links {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-top: 3rem;
    }

    .protocol-link {
        background: var(--bg-elevated);
        border: 1px solid var(--border);
        border-radius: 0.75rem;
        padding: 2rem;
        text-decoration: none;
        color: inherit;
        transition: all 0.3s;
        display: block;
    }

    .protocol-link:hover {
        border-color: var(--accent);
        background: var(--accent-subtle);
        transform: translateY(-4px);
        box-shadow: 0 12px 40px rgba(0, 0, 0, 0.08);
    }

    @media (prefers-color-scheme: dark) {
        .protocol-link:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
        }
    }

    .protocol-link .label {
        font-size: 0.8rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--text-tertiary);
        margin-bottom: 0.5rem;
    }

    .protocol-link h3 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
    }

    .protocol-link p {
        font-size: 0.95rem;
        color: var(--text-secondary);
        line-height: 1.6;
    }

    .protocol-link .arrow {
        margin-top: 1rem;
        color: var(--accent);
        font-weight: 600;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .hero {
            padding-top: 8rem;
            min-height: auto;
        }

        .cta-group {
            flex-direction: column;
        }

        .btn {
            text-align: center;
        }

        .why-matters,
        .how-it-works,
        .intelligence,
        .principles {
            margin: 4rem auto;
        }

        .steps {
            grid-template-columns: 1fr;
        }

        .intelligence-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<script>
    document.getElementById('copy-context')?.addEventListener('click', async () => {
        const button = document.getElementById('copy-context');
        const originalText = button?.textContent;

        try {
            button.textContent = 'Copying...';

            // Fetch the context page
            const response = await fetch('/context.txt');
            const text = await response.text();

            // Try modern clipboard API first
            if (navigator.clipboard && navigator.clipboard.writeText) {
                try {
                    await navigator.clipboard.writeText(text);
                } catch (clipboardErr) {
                    // Fallback for iOS and other browsers
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    textarea.style.position = 'fixed';
                    textarea.style.opacity = '0';
                    document.body.appendChild(textarea);
                    textarea.focus();
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                }
            } else {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                textarea.style.position = 'fixed';
                textarea.style.opacity = '0';
                document.body.appendChild(textarea);
                textarea.focus();
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            }

            // Success feedback
            button.textContent = 'Copied! Paste it in your AI Chat';
            setTimeout(() => {
                if (button) button.textContent = originalText;
            }, 3000);
        } catch (err) {
            console.error('Failed to copy:', err);
            button.textContent = 'Failed to copy';
            setTimeout(() => {
                if (button) button.textContent = originalText;
            }, 2000);
        }
    });
</script>
